# 1.4 제어의 역전(IoC)

마지막으로 분리해야될 것은 테스트 코드에서 커넥션을 받는 부분이다. 팩토리 클래스를 작성하여 커넥션을 받고 DAO를 리턴을 할 수 있다.  
이제 DAO 와 DB 커넥터는 완전히 분리할 수 있고 클라이언트는 팩토리에 요청하여 DAO 를 사용하면 된다.  
지금까지의 과정을 돌이켜보면 사실 정말 별거 아닐 수 있다. 하지만 내가 이직했을때 적어도 동료와의 협업에 조금 더 쉽게 접근할 수 있을 것이다.  
단순한 과정이었지만 그동안 혼자서 개발할 때 많이 생각하지 못했던 부분이 많다.  
조금 더 바른 개발자가 될 수 있는 한발짝을 시작한 것이다.

## 파일 구성

- `com.andrewbae.spring.domain.*`: 자바빈 클래스
- `com.andrewbae.spring.dao.*`: DAO 클래스
- `com.andrewbae.spring.factory.*`: 팩토리 클래스
- `ConnectionMaker.java`: DB 커넥션 인터페이스
- `XConnectionMaker.java`: `ConnectionMaker.java` 구현 코드
- `UserDaoTest.java`: 테스트 코드

## 작업 사항

- `DaoFactory.java`를 생성하여 DB 커넥션을 가져오고 DAO를 생성하여 리턴한다.
- 테스트 코드에서 팩토리 객체를 생성하여 DAO 가져온다.
- 테스트 코드에서 DB 커넥션에 신경 쓸 필요 없이 DAO 를 사용할 수 있다.

## 핵심 사항

- 제어 권한을 상위 템플릿 메소드로 넘기고 자신은 팔요할 때 호출 되어 사용되도록 한다. 즉, 짜놓은 틀에서 수동적으로 동작하게 만든다.

## 참고 사항

일반적인 프로그램의 흐름
1. 사용할 오브젝트를 결정
2. 결정한 오브젝트를 생성
3. 생성된 오브젝트에 있는 메소드 호출
4. 호출된 메소드 안에서 다음에 사용할 것을 결정 호출

 